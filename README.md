# TraderEconomy
Original mod by Astral.

## About
Trader Economy is a Patch for the mod "Trader" (by Dr_J0nes) which enables dynamic prices (based on rarity, demand and supply) and adds an item stock for traders.


## Installation
Make sure Trader is setup-ed correctly on your server. You also gonna need a well made types.xml.

    Add the mod like any other mod to your server.
    Copy the provided TraderVariables.txt file to your "<ServerProfile>/Trader/" directory
    Adjust all values for your needs / settings. You better set BalancedStockMultiplier a bit higher and turn it down later on instead of raising it.
    Start the server -> will generate a database in "<ServerProfile>/Trader/Traderstock/"
    You can fine tune all the values in there.



## Database values

0_Apple.txt
The filename consists of 2 values: TraderID + ItemClassname. (TraderID_ItemClassname.txt)
Each TraderID will have their own files for each item. If you got a TraderID=0 in GM and another with the same ID in Klen, their stocks will always be equal. So if the on in GM runs out of Apples, the one in Klen also does. If you want to split them, you gonna need to create a new Trader with the same items as the other.

<Stock> 110
This value represents the item count that this Trader has. In our example 110 Apples.

<BalancedStock> 100
This value is the stock amount at which the item price won't be affected. You can basically say its the starting stock from which everything is going to be calculated (Prices and how many items to restock). Having this value higher will result in more items to be bought but also decreases the "increase in price per each item bought".
If you want to change this value, you gonna need to work with RealNominal and the <BalancedStockMultiplier> (= 5.00 for this example) option from TraderVariables.txt.
CANNOT be 0!!!

<BasePrice> 10
BuyPrice from TraderConfig.txt ... Ignore this value, just needed to be stored for price calculations.

<BaseSellPrice> A
SellPrice from TraderConfig.txt ... Same as above, you can also ignore this value.
This can either be any Number or A. A will simply multiply <TraderTaxes> value with the BuyPrice.
If you want to set this to A, change SellPrice in TraderConfig.txt to A. (There is an option in TraderVariables.txt to create a TraderConfig2.txt with all SellPrices replaced by A, if you wish to do so.

<RealNominal> 20
At first will equal to the nominal value from types.xml ... <BalancedStock> will be calculated from this value. This value is designed to be modified. Cars and most natural cosumables like Apples, Meat, etc (all items that don't spawn in buildings) don't have a nominal value. You gonna need to go to their files and edit this value in all of them.

<ExcludeFromRestock> 0
If you wish to exclude a certain item from being restocked you can set this to 1. This can be used in combination with "<Stock> 0" for items, that you normaly set to buyprice -1. This will make those items unbuyable unless someone sold this item to this trader (stock +1). or if you simply with to disable any restocks, set <RestockTimer> in TraderVariables.txt to -1.

<RestockTimer> 0
Time in seconds until this item will get restocked. If this is 0, it will use the <DefaultRestockTime> found in TraderVariables.txt

<RestockPercent> 0
% of the differece between BalanceStock to Stock on how many items should be refilled. If this is 0, it will use the <RestockPercent> found in TraderVariables.txt

<FileEnd>

TraderVariables.txt
https://steamcommunity.com/workshop/filedetails/discussion/1874854042/1609400247637151355/

## Formula
You can find the formula under the Functions folder in this link: https://www.desmos.com/calculator/vi72vrsk8f
You can also play around with <BalancedStock>, <BasePrice> and <TraderTaxes> to get a feeling for the Price calculations.
<TraderTaxes> only account for autogenerated SellPrices ( item, *, 500, A )

BalancedStock = types.xml -> nominalValue of that item (basically rarity) (you can setup a global multiplier / or you can change <RealNominal> for manual adjustments)

X axis is ItemCount

Y axis is modified Price

## Shoutout
A big thanks to Dumpgrah and Bee Dup for helping me out developing this mod.
They helped me find a lot of bugs and suggested some cofnig options, that I've wouldn't have thought about it.
If you want to check out their awesome community, you can head over to their discord and find some informations about their server: https://discord.gg/F8TY9aV

## Source Code
As I am not working on this mod anymore (lots of other projects to do) I will provide the source codes for anyone who wishes to update this mod for themselves.
If you want to share your update with everyone else, message me and I will give you the rights to update this mod here yourself.
